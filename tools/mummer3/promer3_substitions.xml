<tool id="promer3_substitutions" name="report substitutions" version="1.0">
    <description>aligns two sets of contigs and reports amino acid substitutions between them</description>
    <requirements>
          <requirement type="package" version="3.23">mummer</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[

        sed -i 's/__mummer@3\.23\/opt/__mummer\\@3\.23\/opt/g' \$CONDA_PREFIX/opt/mummer-3.23/promer;

        promer $reference_fasta $query_fasta;
        delta-filter -g out.delta > out-filter.delta;
        show-snps -T -q out-filter.delta > subs.tab;

    ]]></command>

    <inputs>
        <param name="query_fasta" type="data" format="fasta" optional="false" label="Query FASTA" />
        <param name="reference_fasta" type="data" format="fasta" optional="false" label="Reference FASTA" />
    </inputs>

    <outputs>
        <data format="txt" label="delta" name="output_delta" from_work_dir="out.delta" />
        <data format="txt" label="filtered" name="output_delta_filter" from_work_dir="out-filter.delta" />
        <data format="tabular" label="substitutions" name="output_substitutions" from_work_dir="subs.tab" />
    </outputs>

    <help><![CDATA[
Report Substitutions
=====================

Aligns a set of query contigs against a set of reference contigs and reports the amino acid differences between the two sets of contigs using MUMmer3 (promer):

Kurtz, Stefan et al. “Versatile and Open Software for Comparing Large Genomes.” Genome Biology 5.2 (2004): R12. PMC. Web. 22 Aug. 2018.

The alignments are performed in amino acid space. Only the substitutions from the best set of global alignments are reported in the output.

]]></help>
    <citations>
    </citations>
</tool>
