<tool id="mob_recon" name="MOB-Recon" version="1.4.1">
  <description>(Type contigs and extract plasmid sequences)</description>
  <requirements>
     <requirement type="package" version="1.4.1">mob_suite</requirement>
  </requirements>   
  <command detect_errors="exit_code">
    ln -s '${input}' '${input.name}';
    mob_recon  --num_threads '${GALAXY_SLOTS:-4}' --infile '${input.name}' --evalue '${adv_param.evalue}'  --unicycler_contigs '${adv_param.unicycler_contigs}' --run_circlator '${adv_param.run_circlator}' --run_typer --outdir '.';
  </command>
  <inputs>
    <param name="input" type="data" format="fasta" label="Input" help="FASTA file with contig(s)"/>
    <section name="adv_param" title="Advanced parameters" expanded="False">
      <param name="evalue" label="Minimum e-value threshold for BLAST" type="float"  min="0.000000000000000000001" max="1" value="0.00001"/>
      <param name="unicycler_contigs" label="Check for circularity flag generated by unicycler in contigs fasta headers" type="select" value="True">
        <option value="True">Yes</option>
        <option value="False">No</option>
      </param>
      <param name="run_circlator" label="Run circlator minums2 pipeline to check for circular contigs" type="select" value="True">
        <option value="True">Yes</option>
        <option value="False">No</option>
      </param>

    </section>  
  </inputs>
  <outputs>
    <data name="outfile1" format="tabular" from_work_dir="contig_report.txt" label="${tool.name}: Overall contig MOB-recon report from ${input.name}"/> 
    <data name="outfile2" format="tabular" from_work_dir="repetitive_blast_report.txt" label="${tool.name}: Repetitive elements BLAST report from ${input.name}"/>
    <data name="outfile3" format="fasta" from_work_dir="chromosome.fasta" label="${tool.name}: Chromosomal sequences (if any) from ${input.name}"/>
    <data name="outfile4" format="tabular" from_work_dir="mobtyper_aggregate_report.txt" label="${tool.name}: Aggregate MOB-typer report for all contigs from ${input.name}"/>
  </outputs>
  <tests>
    <test>
        <param name="input" value="plasmid_476.fasta" ftype="fasta"/>
        <section name="adv_param">
         <param name="evalue" value="0.00001"/>
         <param name="unicycler_contigs" value="True"/>
         <param name="run_circlator"  value="True"/>
        </section>
        <output name="outfile1">
          <assert_contents>
            <has_text text="NC_019097"/>
          </assert_contents>  
        </output> 
    </test>
  </tests>
  <help>

**Syntax**

This tool reconstructs individual plasmid sequences from draft genome assemblies using the plasmid reference databases.

For more information please visit https://github.com/phac-nml/mob-suite/. 

-----

**Input:**

A FASTA file with a single or multiple contigs (e.g. a draft genome assembly):


**Output:**

Tab-delimited report listing information for each input contig on its cluster number, possible replicon, relaxase, and repetitive elements types, etc. Refer to https://github.com/phac-nml/mob-suite#mob-recon-contig-report-format for the description of each column.


  </help>
  <citations>
    <citation type="bibtex">
  @misc{githubseqtk,
  author = {Robertson James, Nash John},
  year = {2018},
  title = {MOB-Suite: Software tools for clustering, reconstruction and typing of plasmids from draft assemblies.},
  publisher = {Microbiology Society Journals},
  journal = {Microbial Genomics},
  url = {http://mgen.microbiologyresearch.org/content/journal/mgen},
  note = {Submitted manuscript}
    }</citation>
  </citations>
</tool>
<!--(?P&lt;designation&gt;.+)   ${tool.name} report from ${input.name}-->
